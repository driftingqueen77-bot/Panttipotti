<!doctype html>
<!-- build: v11 Deluxe -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<title>PanttiPotti Deluxe</title>
<style>
  :root{--bg:#fff7e9;--ink:#222;--panel:#e6f0e7;--green:#2f8b3a;--accent:#ff6a00}
  html,body{height:100%;margin:0;background:var(--bg);font-family:-apple-system,system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;color:var(--ink)}
  .w{max-width:560px;margin:0 auto;padding:10px}
  h1{text-align:center;margin:8px 0 6px;font-size:20px}
  .top{display:flex;gap:8px;flex-wrap:wrap;align-items:center;justify-content:space-between}
  .c{background:#fff;border:2px solid #0002;border-radius:10px;padding:6px 10px;font-weight:700;box-shadow:0 2px 0 #0003}
  .best{border-color:#8e44ad}
  #g{width:100%;aspect-ratio:9/16;display:block;background:var(--panel);border:3px solid #234;border-radius:18px;touch-action:none}
  .bar{display:flex;gap:8px;align-items:center;justify-content:space-between;margin:8px 0}
  .btn{display:inline-block;background:var(--accent);color:#fff;border:none;border-radius:10px;padding:12px 16px;font-weight:800;box-shadow:0 4px 0 #0005;cursor:pointer}
  select{appearance:none;border:2px solid #0002;background:#fff;border-radius:10px;padding:10px;font-weight:700}
  .sheet{background:#fff;border:1px dashed #bbb;padding:14px 14px 12px;border-radius:12px}
  .sheet h3{margin:0 0 8px;font-size:16px}
  .sheet .row{display:flex;justify-content:space-between;margin:4px 0}
  .sheet .line{height:1px;background:repeating-linear-gradient(90deg,#ccc 0 8px,transparent 8px 12px);margin:8px 0}
  .muted{opacity:.65}
  .pop{animation:pop .15s ease-out}
  @keyframes pop{from{transform:scale(1)}50%{transform:scale(1.08)}to{transform:scale(1)}}
  .led{position:absolute;inset:0;pointer-events:none;opacity:0;transition:opacity .12s}
  .led.ok{background:rgba(80,255,120,.22)}
  .led.bad{background:rgba(255,60,60,.22)}
  .badge{font-weight:800;padding:4px 8px;border-radius:8px;background:#ffe59a}
</style>

<div class="w">
  <h1>ü•§ PanttiPotti Deluxe</h1>

  <div class="top">
    <div class="c">‚è±Ô∏è <span id="t">40</span>s</div>
    <div class="c">‚Ç¨ <span id="s">0,00</span></div>
    <div class="c">Combo √ó<span id="b">1</span></div>
    <div class="c best">üèÜ <span id="best">0,00</span></div>
    <div class="c"><span id="status" class="muted">Valmis</span></div>
  </div>

  <div style="position:relative">
    <canvas id="g"></canvas>
    <div id="led" class="led"></div>
  </div>

  <div class="bar">
    <div>
      Vaikeus:
      <select id="mode">
        <option value="easy">Helppo</option>
        <option value="normal" selected>Normaali</option>
        <option value="hard">Vaikea</option>
      </select>
      <span id="badges"></span>
    </div>
    <button class="btn" id="start">Aloita / Uudestaan</button>
  </div>

  <div id="rc" class="sheet" style="display:none;margin-top:10px">
    <!-- t√§ytet√§√§n JS:ll√§ -->
  </div>
</div>

<script>
(()=>{
// ===== DOM
const cvs=g, ctx=cvs.getContext('2d');
const timeEl=t, scoreEl=s, comboEl=b, bestEl=best, btn=start, rcEl=rc, modeSel=mode, ledEl=led, statusEl=status, badgesEl=badges;
const BEST_KEY='panttipotti_top5_v11';

// ===== Size
function fit(){const r=cvs.getBoundingClientRect();const h=r.width*16/9;cvs.width=r.width;cvs.height=h;cvs.style.height=h+'px'}
addEventListener('resize',fit); fit();

// ===== State
let run=false,startT=0,time=40,last=0,spawnT=0,spawnEvery=900,progress=0,difficulty=1;
let ents=[],score=0,combo=1,bestCombo=1,streak=0,booster=0,bonus=0; // booster/bonus sekunteina
let counts={smallCan:0,bigCan:0,smallBottle:0,bigBottle:0,wrong:0,gold:0};
const MAX_ENTS=16;
const P={smallCan:.15,bigCan:.20,smallBottle:.15,bigBottle:.40,gold:2.00};
const euro=n=>n.toFixed(2).replace('.',',');
function now(){return performance.now()}

// Highscore (Top5)
function loadTop(){try{return JSON.parse(localStorage.getItem(BEST_KEY)||'[]')}catch(e){return[]}}
function saveTop(arr){try{localStorage.setItem(BEST_KEY,JSON.stringify(arr.slice(0,5)))}catch(e){}}
function pushTop(val){const arr=loadTop();arr.push({v:val,ts:Date.now()});arr.sort((a,b)=>b.v-a.v);saveTop(arr)}
function bestVal(){const arr=loadTop();return arr[0]?arr[0].v:0}
bestEl.textContent=euro(bestVal());

// HUD
function hud(){
  timeEl.textContent=Math.max(0,Math.ceil(time));
  scoreEl.textContent=euro(score);
  comboEl.textContent=Math.floor(combo);
  bestEl.textContent=euro(bestVal());
  const badges=[];
  if(booster>0) badges.push(`<span class="badge">BOOST √ó2 ${Math.ceil(booster)}s</span>`);
  if(bonus>0)   badges.push(`<span class="badge">BONUS √ó2 ${Math.ceil(bonus)}s</span>`);
  badgesEl.innerHTML=badges.join(' ');
}

// Status text
let statusTimer=0;
function setStatus(txt,ms=800){statusEl.textContent=txt;clearTimeout(statusTimer);statusTimer=setTimeout(()=>statusEl.textContent='‚Äî',ms)}

// Reset
function reset(){
  run=false; time=40; spawnT=0; spawnEvery=900; progress=0; difficulty=1;
  ents=[]; score=0; combo=1; bestCombo=1; streak=0; booster=0; bonus=0;
  counts={smallCan:0,bigCan:0,smallBottle:0,bigBottle:0,wrong:0,gold:0};
  rcEl.style.display='none'; led('off'); hud(); setStatus('Valmis',600);
}

// ===== Audio (WebAudio) ‚Äì aktivoituu Aloita-napista
let ac=null, hum=null, gMain=null;
function ensureAudio(){
  const AC=window.AudioContext||window.webkitAudioContext; if(!AC) return;
  if(!ac){ac=new AC(); gMain=ac.createGain(); gMain.gain.value=0.35; gMain.connect(ac.destination);}
  if(ac.state==='suspended') ac.resume();
  if(!hum){ // kevyt hurina
    hum=ac.createOscillator(); const g=ac.createGain(); g.gain.value=0.02; hum.type='sine'; hum.frequency.value=120;
    hum.connect(g); g.connect(gMain); hum.start();
  }
}
function blip(freq=900,dur=.06,type='triangle',vol=.3){
  if(!ac) return; const o=ac.createOscillator(), g=ac.createGain();
  o.type=type; o.frequency.setValueAtTime(freq, ac.currentTime); g.gain.value=vol;
  o.connect(g); g.connect(gMain); o.start();
  g.gain.exponentialRampToValueAtTime(0.0001, ac.currentTime+dur);
  o.stop(ac.currentTime+dur);
}
function sfxOK(cat){
  const map={smallCan:1100,bigCan:900,smallBottle:800,bigBottle:650,gold:1500};
  blip(map[cat]||950,0.07,'triangle',0.25);
  if(navigator.vibrate) navigator.vibrate(18);
  led('ok');
}
function sfxFail(secs){
  blip(220,0.08,'sawtooth',0.35);
  if(navigator.vibrate) navigator.vibrate([30,40,30]);
  led('bad'); setStatus(`Virhe ‚Äì${secs}s`,900);
}
function sfxPrint(){ for(let i=0;i<7;i++) setTimeout(()=>blip(700-i*35,0.03,'square',0.18),i*60) }

// LED flash
let ledTO=null;
function led(kind){
  if(kind==='off'){ledEl.style.opacity=0;return}
  ledEl.className='led '+(kind==='ok'?'ok':'bad');
  ledEl.style.opacity=1; clearTimeout(ledTO); ledTO=setTimeout(()=>ledEl.style.opacity=0,140);
}

// ===== Start
function startGame(){
  ensureAudio(); reset(); run=true; startT=now(); last=0;
  setStatus('K√§ynniss√§');
  requestAnimationFrame(loop);
}
btn.addEventListener('click', startGame);
btn.addEventListener('touchstart', e=>{startGame(); e.preventDefault()},{passive:false});

// ===== Types (aidommat v√§rit, lis√§tty kultainen t√∂lkki & rikkin√§inen pullo)
const TYPES=[
  // hyv√§t
  {id:'colaSmall', good:1, val:P.smallCan,    shape:'can',    color:'#e41d1d', w:36,h:50,  cat:'smallCan'},
  {id:'pepsiSmall',good:1, val:P.smallCan,    shape:'can',    color:'#0055a4', w:36,h:50,  cat:'smallCan'},
  {id:'colaBig',   good:1, val:P.bigCan,      shape:'can',    color:'#111',    w:40,h:70,  cat:'bigCan'},
  {id:'pepsiMax',  good:1, val:P.bigCan,      shape:'can',    color:'#000',    w:40,h:70,  cat:'bigCan'},
  {id:'aquaSmall', good:1, val:P.smallBottle, shape:'bottle', color:'#8fd3ff', w:34,h:62,  cat:'smallBottle'},
  {id:'aquaBig',   good:1, val:P.bigBottle,   shape:'bottle', color:'#87cefa', w:46,h:100, cat:'bigBottle'},
  {id:'goldCan',   good:1, val:P.gold,        shape:'can',    color:'#d4af37', w:40,h:60,  cat:'gold'}, // erikoisbonus

  // v√§√§r√§t
  {id:'milk',   good:0, penalty:5,  shape:'box',   color:'#87c7ff', w:44,h:60},
  {id:'pizza',  good:0, penalty:5,  shape:'pizza', color:'#f4a261', w:64,h:26},
  {id:'broken', good:0, penalty:10, shape:'bottle',color:'#b0b0b0', w:40,h:90, cracked:true}
];

const rnd=(a,b)=>Math.random()*(b-a)+a;

// piirto
function rr(x,y,w,h,r){const R=Math.min(r,w/2,h/2);ctx.beginPath();ctx.moveTo(x+R,y);ctx.arcTo(x+w,y,x+w,y+h,R);ctx.arcTo(x+w,y+h,x,y+h,R);ctx.arcTo(x,y+h,x,y,R);ctx.arcTo(x,y,x+w,y,R);ctx.closePath()}
const mouth={x:0,y:0,w:0,h:0}, funnel={x:0,y:0,w:0,h:0};
function drawMachine(){
  const W=cvs.width,H=cvs.height,mx=16,my=H*.2,mw=W-32,mh=H*.22;
  // tausta lattialaatat
  const tile=18; ctx.fillStyle='#e9efe9'; ctx.fillRect(0,0,W,H);
  ctx.fillStyle='#dfe7df'; for(let y=0;y<H;y+=tile){for(let x=0;x<W;x+=tile) if(((x+y)/tile)&1) ctx.fillRect(x,y,tile,tile)}
  // paneeli
  ctx.fillStyle=modeSel.value==='hard'?'#2c7a34':'#3e8f4a'; rr(mx,my,mw,mh,16); ctx.fill();
  // suppilo & suu
  funnel.x=W*.15; funnel.w=W*.70; funnel.y=my+mh*.10; funnel.h=mh*.80;
  mouth.x=W*.22; mouth.w=W*.56; mouth.y=my+mh*.22; mouth.h=mh*.56;
  ctx.fillStyle='#0c2410'; rr(mouth.x,mouth.y,mouth.w,mouth.h,26); ctx.fill();
  // hinnat
  ctx.fillStyle='#fff'; ctx.font='bold 16px system-ui,-apple-system,Segoe UI,Roboto';
  ctx.fillText('+0,15‚Ç¨ / +0,20‚Ç¨ / +0,40‚Ç¨ / ‚≠ê 2,00‚Ç¨', mx+14, my+22);
  if(bonus>0){ ctx.fillStyle='#ffff66'; ctx.fillText('BONUS x2!', mx+14, my+42); }
}

// yksityiskohtaiset t√∂lkit/pullot
function drawCan(e){
  const g=ctx.createLinearGradient(-e.w/2,0,e.w/2,0);
  if(e.t.id==='goldCan'){ g.addColorStop(0,'#b9951e'); g.addColorStop(.5,'#e6c766'); g.addColorStop(1,'#b9951e'); }
  else { g.addColorStop(0,e.t.color); g.addColorStop(.5,shade(e.t.color,0.2)); g.addColorStop(1,e.t.color); }
  ctx.fillStyle=g; rr(-e.w/2,-e.h/2,e.w,e.h,8); ctx.fill();
  ctx.fillStyle='#ffffffcc'; rr(-e.w/2+4,-e.h*0.18,e.w-8,e.h*0.28,6); ctx.fill(); // etikettivy√∂
  ctx.fillStyle='#cfd6db'; rr(-e.w/2,-e.h/2-4,e.w,10,4); ctx.fill(); // kansi
  ctx.fillStyle='#b5bcc1'; rr(-e.w*0.16,-e.h/2-1.5,e.w*0.32,4,2); ctx.fill(); // vetolenkki
  ctx.fillStyle='#b7bec3'; rr(-e.w/2,-e.h/2+e.h-6,e.w,8,4); ctx.fill(); // pohja
  ctx.fillStyle='#ffffff66'; rr(-e.w/2+6,-e.h/2+6,e.w-12,e.h-12,6); ctx.fill(); // kiilto
}
function drawBottle(e){
  const g=ctx.createLinearGradient(0,-e.h/2,0,e.h/2);
  g.addColorStop(0,shade(e.t.color,-.05)); g.addColorStop(.5,e.t.color); g.addColorStop(1,shade(e.t.color,.08));
  ctx.fillStyle=g; rr(-e.w*0.35,-e.h/2,e.w*0.7,e.h,12); ctx.fill();
  ctx.fillStyle='#fff6'; rr(-e.w*0.35+4,-e.h/2+8,e.w*0.7-8,e.h-16,10); ctx.fill(); // kiilto
  ctx.fillStyle=e.t.cracked?'#7a2a2a':'#155'; rr(-e.w*0.12,-e.h/2-6,e.w*0.24,8,3); ctx.fill(); // korkki
  if(e.t.cracked){ ctx.strokeStyle='#7a2a2a'; ctx.lineWidth=2; ctx.beginPath(); ctx.moveTo(-e.w*0.2,-e.h*0.2); ctx.lineTo(e.w*0.2,0); ctx.lineTo(-e.w*0.15,e.h*0.2); ctx.stroke(); }
}
function drawMilk(e){ctx.fillStyle=e.t.color; rr(-e.w/2,-e.h/2,e.w,e.h,8); ctx.fill(); ctx.fillStyle='#fff'; ctx.fillRect(-e.w/2+6,-e.h/2+6,e.w-12,e.h/2)}
function drawPizza(e){ctx.fillStyle=e.t.color; rr(-e.w/2,-e.h/2,e.w,e.h*0.4,6); ctx.fill(); ctx.fillRect(-e.w/2,-e.h/2+e.h*0.4,e.w,e.h*0.45); ctx.fillStyle='#0002'; ctx.fillRect(-e.w/2,-e.h/2+e.h*0.4,e.w,4)}
function drawEntity(e){ctx.save();ctx.translate(e.x,e.y);ctx.rotate(e.a||0); if(e.t.shape==='can')drawCan(e); else if(e.t.shape==='bottle')drawBottle(e); else if(e.t.shape==='box')drawMilk(e); else drawPizza(e); ctx.restore()}
function shade(hex,amt){ // rough lighten/darken
  try{const c = hex.replace('#',''); const n=parseInt(c,16); let r=(n>>16)&255,g=(n>>8)&255,b=n&255; r=Math.max(0,Math.min(255, r+255*amt)); g=Math.max(0,Math.min(255, g+255*amt)); b=Math.max(0,Math.min(255, b+255*amt)); return '#'+((1<<24)+(r<<16)+(g<<8)+b).toString(16).slice(1);}catch(e){return hex}
}

// ===== Spawning & movement
function spawnOne(){
  // mood: easy / normal / hard -> v√§√§rien todenn√§k√∂isyys
  const m=modeSel.value;
  let goodProb = m==='easy' ? 0.95 : m==='normal' ? 0.80 : 0.65;
  // satunnainen bonusvaihe
  if(bonus<=0 && Math.random()<0.03) bonus = 8; // 8s bonus
  const pool = Math.random()<goodProb ? TYPES.filter(t=>t.good) : TYPES.filter(t=>!t.good);
  // kultainen t√∂lkki harvinainen
  if(Math.random()<0.025) pool.push(TYPES.find(x=>x.id==='goldCan'));
  const t=pool[Math.floor(Math.random()*pool.length)];
  const x=rnd(30,cvs.width-30), y=rnd(cvs.height*0.74,cvs.height-40);
  const base = m==='easy'?0.42 : m==='normal'?0.55 : 0.68; // px/ms kerroin
  const speed = base * (1 + progress*0.9); // kiihtyy loppua kohti
  ents.push({t,x,y,w:t.w,h:t.h,a:rnd(-.05,.05),vx:0,vy:0,speed});
}
function steerToMouth(o,dt){
  const cx=mouth.x+mouth.w/2, cy=mouth.y+mouth.h/2;
  const dx=cx-o.x, dy=cy-o.y, len=(Math.hypot(dx,dy)||1);
  const ux=dx/len, uy=dy/len;
  const noise=(Math.random()-0.5)*0.02;
  const s=o.speed*(0.7+Math.random()*0.2);
  o.x += (ux*s+noise)*60*dt; o.y += (uy*s+noise)*60*dt;
  o.a  += (Math.random()-0.5)*.02;
}

// ===== Input (drag + tap)
let ptr={down:false,x:0,y:0,target:null,dx:0,dy:0};
function pos(evt){const r=cvs.getBoundingClientRect();const t=evt.touches?evt.touches[0]:evt;return {x:t.clientX-r.left,y:t.clientY-r.top}}
function onDown(e){if(!run)return; const p=pos(e); ptr.down=true; ptr.x=p.x; ptr.y=p.y;
  for(let i=ents.length-1;i>=0;i--){const o=ents[i]; if(Math.abs(p.x-o.x)<o.w/2 && Math.abs(p.y-o.y)<o.h/2){ptr.target=o; ptr.dx=o.x-p.x; ptr.dy=o.y-p.y; break}} e.preventDefault()}
function onMove(e){if(!run||!ptr.down)return; const p=pos(e); ptr.x=p.x; ptr.y=p.y; if(ptr.target){ptr.target.x=p.x+ptr.dx; ptr.target.y=p.y+ptr.dy;} e.preventDefault()}
function onUp(e){if(!run)return; ptr.down=false; ptr.target=null; e.preventDefault()}
function onTap(e){if(!run)return; const p=pos(e); if(!(p.x>mouth.x&&p.x<mouth.x+mouth.w&&p.y>mouth.y&&p.y<mouth.y+mouth.h)) return;
  // nappaamme l√§himm√§n
  let best=null,bestd=1e9; for(const o of ents){const d=Math.hypot(p.x-o.x,p.y-o.y); if(d<bestd){best=o; bestd=d}}
  if(best && bestd<90) collect(best); e.preventDefault()}
cvs.addEventListener('mousedown',onDown); cvs.addEventListener('mousemove',onMove); addEventListener('mouseup',onUp);
cvs.addEventListener('touchstart',onDown,{passive:false}); cvs.addEventListener('touchmove',onMove,{passive:false}); cvs.addEventListener('touchend',onUp,{passive:false});
cvs.addEventListener('click', onTap);

// ===== Collect & rules
function inRect(o,r){return o.x>r.x && o.x<r.x+r.w && o.y>r.y && o.y<r.y+r.h}
function tryCollect(o){ if(!inRect(o,mouth)) return; collect(o); }
function collect(o){
  if(o.t.good){
    let mult = 1; if(booster>0) mult*=2; if(bonus>0) mult*=2;
    score += o.t.val * mult * combo;
    combo = Math.min(5, combo + 0.25); bestCombo=Math.max(bestCombo,Math.floor(combo));
    streak++;
    if(o.t.cat) counts[o.t.cat]++; if(o.t.id==='goldCan') counts.gold++;
    sfxOK(o.t.cat||'smallCan');
    scoreEl.parentElement.classList.add('pop'); setTimeout(()=>scoreEl.parentElement.classList.remove('pop'),120);
    if(streak>=5 && booster<=0){ // aktivoi combo-boosti
      booster=10; time=Math.min(60,time+5); setStatus('Combo BOOST √ó2 +5s',1400);
    }
  }else{
    const pen = o.t.penalty||5;
    time = Math.max(0,time - pen);
    combo = 1; streak = 0; counts.wrong++; sfxFail(pen);
  }
  ents = ents.filter(x=>x!==o); hud();
}

// ===== Loop
function loop(ts){
  if(!run) return;
  if(!last) last=ts; const dt=Math.min(32,ts-last)/1000; last=ts;

  // aika & etenem√§
  progress = 1 - (time/40); // 0..1
  time -= dt; if(booster>0) booster-=dt; if(bonus>0) bonus-=dt;
  if(time<=0){ time=0; run=false; finish(); hud(); return; }

  // spawnaus
  spawnT += dt*1000;
  // tihenee loppua kohti, vaikeuden mukaan
  const mode=modeSel.value;
  const base = mode==='easy'? 950 : mode==='normal'? 800 : 650;
  spawnEvery = Math.max(400, base - progress*300);
  if(spawnT>spawnEvery && ents.length<MAX_ENTS){ spawnOne(); spawnT=0; }

  // liike + ker√§ys
  drawMachine();
  ctx.save(); // draw scene
  ctx.clearRect(0,0,cvs.width,cvs.height);
  ctx.fillStyle='#dcefe1'; ctx.fillRect(0,0,cvs.width,cvs.height);
  drawMachine();
  for(const o of ents){ steerToMouth(o,dt); tryCollect(o); }
  ents.forEach(drawEntity);
  ctx.restore();

  hud();
  requestAnimationFrame(loop);
}

// ===== Finish / Receipt
function finish(){
  pushTop(score);
  const date=new Date();
  const top=loadTop();
  const makeRow=(name,cnt,price)=>`<div class="row"><span>${name} √ó ${cnt}</span><span>‚Ç¨ ${(cnt*price).toFixed(2).replace('.',',')}</span></div>`;
  rcEl.innerHTML=[
    `<h3>üßæ Panttikuitit Oy</h3>`,
    makeRow('Pieni t√∂lkki 0,33l',counts.smallCan,P.smallCan),
    makeRow('Iso t√∂lkki 0,5l',counts.bigCan,P.bigCan),
    makeRow('Pieni pullo 0,33l',counts.smallBottle,P.smallBottle),
    makeRow('Iso pullo 1,5l',counts.bigBottle,P.bigBottle),
    `<div class="row"><span>‚≠ê Kultainen t√∂lkki</span><span>‚Ç¨ ${(counts.gold*P.gold).toFixed(2).replace('.',',')}</span></div>`,
    `<div class="row"><span class="muted">Virheit√§ (‚Äì5/‚Äì10s)</span><span class="muted">√ó ${counts.wrong}</span></div>`,
    `<div class="line"></div>`,
    `<div class="row" style="font-weight:800"><span>Yhteens√§</span><span>‚Ç¨ ${euro(score)}</span></div>`,
    `<div class="row"><span>Paras combo</span><span>√ó${Math.max(1,Math.floor(bestCombo))}</span></div>`,
    `<div class="line"></div>`,
    `<div class="row"><span>${date.toLocaleDateString()} ${date.toLocaleTimeString().slice(0,5)}</span><span>Kiitos asioinnista</span></div>`,
    `<div style="height:24px;background:repeating-linear-gradient(90deg,#000 0 3px,transparent 3px 6px);margin-top:6px"></div>`,
    `<div class="line"></div>`,
    `<div><b>Top 5</b><ol style="margin:6px 0 0 18px">${top.map(x=>`<li>‚Ç¨ ${euro(x.v)}</li>`).join('')}</ol></div>`,
    `<div style="text-align:center;margin-top:10px"><button class="btn" id="shareBtn">Jaa tulos</button></div>`
  ].join('');
  rcEl.style.display='block';
  sfxPrint();

  // share
  setTimeout(()=>{
    const shareBtn=document.getElementById('shareBtn');
    if(!shareBtn) return;
    shareBtn.onclick=async()=>{
      const txt=`PanttiPotti ‚Äì Sain ‚Ç¨ ${euro(score)}! Paras combo √ó${Math.max(1,Math.floor(bestCombo))}. Pelaa: ${location.href.split('?')[0]}`;
      if(navigator.share){ try{ await navigator.share({title:'PanttiPotti', text:txt}); }catch(e){} }
      else if(navigator.clipboard){ try{ await navigator.clipboard.writeText(txt); setStatus('Tulos kopioitu leikep√∂yd√§lle'); }catch(e){} }
    };
  },0);
}

hud(); // init

})();
</script>
